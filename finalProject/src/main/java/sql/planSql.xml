<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="korea.plan">
	<!-- select start -->
		<select id="planList" resultType="korea.plan.model.PlanDTO">
			select * from plan_main
		</select>
		
		<select id="lastSaveIdx" resultType="korea.plan.model.PlanDTO">
			select * from plan_main  
			where rownum = 1 and plan_writer = 1
			order by plan_idx desc
		</select>
		
		<select id="myPlanList" resultType="korea.plan.model.PlanDTO">
			select * from
			(select rownum as rnum, a.* from
			(select * from plan_main order by plan_idx desc) a) b 
			<![CDATA[
				where rnum >= (#{cp} -1) * #{pageRow} + 1 and rnum <= #{cp} * #{pageRow}
   			]]>
			and plan_writer = #{idx}
		</select>
		
		<select id="myTotalCnt" parameterType="int" resultType="int">
			select count(*) from plan_main where plan_idx = #{idx}
		</select>
		
		<select id="planDetail" parameterType="int" resultType="korea.plan.model.PlanDetailDTO">
			select * from plan_detail
			where pland_pidx = #{pidx}
			order by pland_day asc, pland_order asc
		</select>
		
		<select id="planMainContent" parameterType="int" resultType="korea.plan.model.PlanDTO">
			select * from plan_main
			where plan_idx = #{pidx}
		</select>
		
	<!-- select end -->
		
	<!-- insert start -->
		<select id="planMainWrite" parameterType="korea.plan.model.PlanDTO" resultType="int">
			insert into plan_main (plan_idx,plan_subject,plan_writer,plan_writedate,plan_start,plan_readnum) values
			(plan_idx.nextval,#{plan_subject},#{plan_writer},sysdate,#{plan_start},0)	
		</select>
	<!-- insert end -->
	
	<!-- update start -->
	<!-- update end -->


	<!-- delete start -->
	<!-- delete end -->
	
	
	
</mapper>