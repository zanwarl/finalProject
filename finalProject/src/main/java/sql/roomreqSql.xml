<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="korea.roomreq">
	<!-- <select id="roomreqList" resultType="korea.roomreq.model.RoomreqDTO" 
		parameterType="String"> select * from roomreq where userid = #{userid} </select> -->
	
		
	<insert id="roomreqInsert" parameterType="korea.roomreq.model.RoomreqDTO">
	
		<selectKey keyProperty="reqidx" resultType="int" order="BEFORE" >
		
		select reqidx.nextval from dual
		</selectKey>
	
		insert into roomreq
		values
		(#{reqidx},#{userid},#{roomidx},#{count},
		to_char (sysdate , 'yyyy/mm/dd hh24:mi:ss'),#{checkindate},#{checkoutdate},0)
	</insert>
	<!-- <select id="roomreqCon2" parameterType="int"
		resultType="korea.roomreq.model.RoomreqDTO">
		select * from roomreq where reqidx = #{idx}
	</select> -->

	
 	<select id="roomReqOK" parameterType="int" resultType="korea.roomreq.model.RoomreqDTO">
 		select * from roomreq where reqidx = #{reqidx}
 	</select>

	<select id="roomReqTotalCntSql" resultType="int" parameterType="String">
		select count(*) from roomreq where userId = #{userId}
		<!-- roomReqTotalCnt -->
	</select>


	<update id="roomCancelSql" parameterType="int">

		update roomreq set paid = -1 where reqIdx = #{reqIdx}
	</update>



	<select id="roomreqList" resultType="korea.roomreq.model.RoomreqDTO"
		parameterType="map">
		<!-- select * from roomreq where userId = #{userId} -->
		 <![CDATA[ 
  select * from (select rownum rnum,a.* from (select * from roomReq where userId = #{userId} order by reqidx   ) a)b where rnum>=#{startNum} and rnum<=#{endNum} 
   ]]>


	</select>
	
	<update id="paidSql" parameterType="int" >
	
	update roomreq set paid = 1 where reqidx = #{reqIdx}
	</update>

<!-- 

<resultMap id="roomInfo" type="java.util.HashMap">
        <result javaType="java.lang.String" column="bookName" property="bookName"/>
        <result javaType="데이터타입" column="db컬럼명" property="맵에서 키값"/>
</resultMap>
 -->

	<select id="myRoomListSql" resultType="String"  parameterType="String">

		select roomname
		from roomadd
		where useridx in (

		select member_idx
		from member
		where member_id = #{userId}
		)


	</select>

</mapper>